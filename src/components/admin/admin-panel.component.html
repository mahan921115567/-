
@if (isLocked()) {
  <div class="fixed inset-0 bg-white dark:bg-gray-900 z-50 flex flex-col items-center justify-center p-4">
    <div class="bg-gray-100 dark:bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-md text-center border border-yellow-500/30">
      <h2 class="text-2xl font-bold text-yellow-500 dark:text-yellow-400 mb-6">قفل امنیتی ادمین</h2>
      <p class="text-gray-600 dark:text-gray-400 mb-4">برای دسترسی به پنل مدیریت، لطفا پین کد را وارد کنید.</p>
      
      <input 
        type="password" 
        [(ngModel)]="enteredPin" 
        (keyup.enter)="unlockApp()"
        class="w-full text-center text-3xl tracking-widest p-3 bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white mb-6 focus:ring-2 focus:ring-yellow-500 outline-none" 
        placeholder="••••">
      
      <button (click)="unlockApp()" class="w-full bg-amber-400 hover:bg-amber-500 text-black font-bold py-3 px-6 rounded-lg transition-colors mb-4">
        باز کردن قفل
      </button>
      <button (click)="logout()" class="text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">خروج از حساب</button>
      
      @if (lockMessage()) {
        <p class="text-red-500 dark:text-red-400 mt-4 font-semibold animate-pulse">{{ lockMessage() }}</p>
      }
    </div>
  </div>
} @else {
  <div class="w-full">
    <header class="text-center mb-8 relative">
      <h1 class="text-3xl sm:text-4xl font-bold text-yellow-500 dark:text-yellow-400">پنل مدیریت</h1>
      <p class="text-gray-500 dark:text-gray-400 mt-2">مدیریت تراکنش‌ها و تنظیمات صرافی</p>
      <button (click)="logout()" class="absolute top-0 left-0 bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded-lg text-sm transition-colors">خروج</button>
    </header>

    <nav class="flex justify-center bg-gray-100 dark:bg-gray-800 rounded-lg p-2 mb-8 shadow-lg flex-wrap">
      <button (click)="currentView.set('transactions')" [class.bg-amber-400]="currentView() === 'transactions'" [class.text-black]="currentView() === 'transactions'" [class.font-bold]="currentView() === 'transactions'" class="flex-1 py-2 px-4 rounded-md text-center font-semibold transition-colors duration-300 text-gray-800 dark:text-gray-200 hover:bg-amber-400/50">تراکنش‌ها</button>
      <button (click)="currentView.set('deposits')" [class.bg-green-500]="currentView() === 'deposits'" [class.text-white]="currentView() === 'deposits'" [class.font-bold]="currentView() === 'deposits'" class="flex-1 py-2 px-4 rounded-md text-center font-semibold transition-colors duration-300 text-gray-800 dark:text-gray-200 hover:bg-green-500/50 mx-2">واریز ارز</button>
      <button (click)="currentView.set('toman_requests')" [class.bg-gray-500]="currentView() === 'toman_requests'" [class.text-white]="currentView() === 'toman_requests'" [class.font-bold]="currentView() === 'toman_requests'" class="flex-1 py-2 px-4 rounded-md text-center font-semibold transition-colors duration-300 text-gray-800 dark:text-gray-200 hover:bg-gray-500/50">درخواست‌های تومان</button>
      <button (click)="currentView.set('broadcast')" [class.bg-gray-500]="currentView() === 'broadcast'" [class.text-white]="currentView() === 'broadcast'" [class.font-bold]="currentView() === 'broadcast'" class="flex-1 py-2 px-4 rounded-md text-center font-semibold transition-colors duration-300 text-gray-800 dark:text-gray-200 hover:bg-gray-500/50 mx-2">پیام همگانی</button>
      <button (click)="currentView.set('settings')" [class.bg-gray-500]="currentView() === 'settings'" [class.text-white]="currentView() === 'settings'" [class.font-bold]="currentView() === 'settings'" class="flex-1 py-2 px-4 rounded-md text-center font-semibold transition-colors duration-300 text-gray-800 dark:text-gray-200 hover:bg-gray-500/50 ml-2">تنظیمات</button>
    </nav>

    <main class="bg-gray-100 dark:bg-gray-800 p-6 rounded-xl shadow-2xl">
      @switch (currentView()) {
        @case ('transactions') {
          <div class="space-y-8">
            <div>
              <h2 class="text-2xl font-bold text-amber-500 dark:text-amber-400 mb-4">تراکنش‌های در انتظار ({{ pendingTransactions().length }})</h2>
              <div class="space-y-3 max-h-96 overflow-y-auto pr-2">
                @if (pendingTransactions().length === 0) { <p class="text-center text-gray-500 py-4">هیچ تراکنش در انتظاری وجود ندارد.</p> } 
                @else { @for (tx of pendingTransactions(); track tx.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg">
                      <div class="flex items-center justify-between flex-wrap gap-2">
                        <div>
                          <p class="font-bold text-gray-900 dark:text-white">{{ tx.username }} - @switch(tx.type){@case('buy'){خرید} @case('sell'){فروش} @case('withdraw'){برداشت}} {{ tx.cryptoAmount | number:'1.2-6' }} {{ tx.cryptoSymbol }}</p>
                          <p class="text-sm text-gray-600 dark:text-gray-400">{{ tx.timestamp | date:'yyyy/MM/dd HH:mm' }} - ارزش: {{ tx.irtAmount | number:'1.0-0' }} تومان</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse flex-shrink-0"><button (click)="approve(tx.id)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">تایید</button><button (click)="reject(tx.id)" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">رد</button></div>
                      </div>
                      @if(tx.type === 'withdraw' && tx.destinationAddress) { <div class="mt-2 pt-2 border-t border-gray-300 dark:border-gray-600/50"><p class="text-xs text-gray-600 dark:text-gray-300">آدرس مقصد:</p><p class="text-sm text-yellow-600 dark:text-yellow-300 font-mono break-all">{{ tx.destinationAddress }}</p></div> }
                    </div>
                } }
              </div>
            </div>
            <div>
              <h2 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4">تاریخچه تراکنش‌ها</h2>
               <div class="space-y-3 max-h-96 overflow-y-auto pr-2">
                @if (completedTransactions().length === 0) { <p class="text-center text-gray-500 py-4">هیچ تراکنش تکمیل شده‌ای وجود ندارد.</p> } 
                @else { @for (tx of completedTransactions(); track tx.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg opacity-80">
                      <div class="flex items-center justify-between">
                        <div>
                          <p class="font-bold text-gray-900 dark:text-white">{{ tx.username }} - @switch(tx.type){@case('buy'){خرید} @case('sell'){فروش} @case('withdraw'){برداشت}} {{ tx.cryptoAmount | number:'1.2-6' }} {{ tx.cryptoSymbol }}</p>
                          <p class="text-sm text-gray-600 dark:text-gray-400">{{ tx.timestamp | date:'yyyy/MM/dd HH:mm' }}</p>
                        </div>
                        <span class="font-bold px-3 py-1 rounded-full text-sm flex-shrink-0" [class.bg-green-500/20]="tx.status === 'approved'" [class.text-green-500 dark:text-green-400]="tx.status === 'approved'" [class.bg-red-500/20]="tx.status === 'rejected'" [class.text-red-500 dark:text-red-400]="tx.status === 'rejected'">
                          @switch (tx.status) { @case ('approved') { تایید شده } @case ('rejected') { رد شده } }
                        </span>
                      </div>
                       @if(tx.type === 'withdraw' && tx.destinationAddress) { <div class="mt-2 pt-2 border-t border-gray-300 dark:border-gray-600/50"><p class="text-xs text-gray-500 dark:text-gray-400">آدرس مقصد:</p><p class="text-sm text-gray-600 dark:text-gray-300 font-mono break-all">{{ tx.destinationAddress }}</p></div> }
                    </div>
                } }
              </div>
            </div>
          </div>
        }
        @case('deposits') {
          <div class="space-y-8">
            <div>
              <h2 class="text-2xl font-bold text-green-500 dark:text-green-400 mb-4">درخواست‌های واریز ارز ({{ pendingDepositRequests().length }})</h2>
              <div class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
                @if (pendingDepositRequests().length === 0) { <p class="text-center text-gray-500 py-4">هیچ درخواست واریزی در انتظار نیست.</p> } 
                @else { @for (req of pendingDepositRequests(); track req.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg">
                      <div class="flex items-start justify-between flex-wrap gap-4">
                        <div class="flex-grow"><p class="font-bold text-gray-900 dark:text-white">{{ req.username }} - درخواست واریز {{ req.cryptoAmount | number:'1.2-6' }} {{ req.cryptoSymbol }}</p><p class="text-sm text-gray-600 dark:text-gray-400">{{ req.timestamp | date:'yyyy/MM/dd HH:mm' }}</p>
                          @if (req.txHash) { <div class="mt-2 pt-2 border-t border-gray-300 dark:border-gray-600/50"><p class="text-xs text-gray-600 dark:text-gray-300">هش تراکنش:</p><p class="text-sm text-green-600 dark:text-green-300 font-mono break-all">{{ req.txHash }}</p></div> }
                        </div>
                        <div class="flex space-x-2 space-x-reverse flex-shrink-0 self-center"><button (click)="approveDeposit(req.id)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">تایید</button><button (click)="rejectDeposit(req.id)" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">رد</button></div>
                        <div class="w-full mt-2"><p class="text-xs text-gray-600 dark:text-gray-300 mb-1">تصویر رسید:</p><img [src]="req.receiptImageUrl" alt="تصویر رسید" class="rounded-lg max-w-full h-auto border-2 border-gray-300 dark:border-gray-600"></div>
                      </div>
                    </div>
                } }
              </div>
            </div>
            <div>
              <h2 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4">تاریخچه واریز ارز</h2>
               <div class="space-y-3 max-h-96 overflow-y-auto pr-2">
                @if (completedDepositRequests().length === 0) { <p class="text-center text-gray-500 py-4">هیچ درخواست تکمیل شده‌ای وجود ندارد.</p> } 
                @else { @for (req of completedDepositRequests(); track req.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg opacity-80">
                      <div class="flex items-center justify-between">
                        <div><p class="font-bold text-gray-900 dark:text-white">{{ req.username }} - واریز {{ req.cryptoAmount | number:'1.2-6' }} {{ req.cryptoSymbol }}</p><p class="text-sm text-gray-600 dark:text-gray-400">{{ req.timestamp | date:'yyyy/MM/dd HH:mm' }}</p></div>
                        <span class="font-bold px-3 py-1 rounded-full text-sm flex-shrink-0" [class.bg-green-500/20]="req.status === 'approved'" [class.text-green-500 dark:text-green-400]="req.status === 'approved'" [class.bg-red-500/20]="req.status === 'rejected'" [class.text-red-500 dark:text-red-400]="req.status === 'rejected'">
                          @switch (req.status) { @case ('approved') { تایید شده } @case ('rejected') { رد شده } }
                        </span>
                      </div>
                    </div>
                } }
              </div>
            </div>
          </div>
        }
        @case('toman_requests') {
          <div class="space-y-8">
            <div>
              <h2 class="text-2xl font-bold text-gray-500 dark:text-gray-400 mb-4">درخواست‌های تومان در انتظار ({{ pendingTomanRequests().length }})</h2>
              <div class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
                @if (pendingTomanRequests().length === 0) { <p class="text-center text-gray-500 py-4">هیچ درخواستی در انتظار نیست.</p> } 
                @else { @for (req of pendingTomanRequests(); track req.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg">
                      <div class="flex items-start justify-between flex-wrap gap-4">
                        <div class="flex-grow">
                          <p class="font-bold text-gray-900 dark:text-white">{{ req.username }} - 
                            @if(req.type === 'toman_deposit') { <span class="text-green-600 dark:text-green-400">واریز تومان</span> } @else { <span class="text-yellow-600 dark:text-yellow-400">برداشت تومان</span> }
                          </p>
                          <p class="text-lg font-mono">{{ req.amount | number:'1.0-0' }} تومان</p>
                          <p class="text-sm text-gray-600 dark:text-gray-400">{{ req.timestamp | date:'yyyy/MM/dd HH:mm' }}</p>
                          @if (req.type === 'toman_withdraw' && req.shabaNumber) { <div class="mt-2 pt-2 border-t border-gray-300 dark:border-gray-600/50"><p class="text-xs text-gray-600 dark:text-gray-300">شماره شبا:</p><p class="text-sm text-gray-600 dark:text-gray-400 font-mono break-all">{{ req.shabaNumber }}</p></div> }
                        </div>
                        <div class="flex space-x-2 space-x-reverse flex-shrink-0 self-center"><button (click)="approveToman(req.id)" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">تایید</button><button (click)="rejectToman(req.id)" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">رد</button></div>
                        @if (req.type === 'toman_deposit' && req.receiptImageUrl) { <div class="w-full mt-2"><p class="text-xs text-gray-600 dark:text-gray-300 mb-1">تصویر رسید:</p><img [src]="req.receiptImageUrl" alt="تصویر رسید" class="rounded-lg max-w-full h-auto border-2 border-gray-300 dark:border-gray-600"></div> }
                      </div>
                    </div>
                } }
              </div>
            </div>
            <div>
              <h2 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4">تاریخچه درخواست‌های تومان</h2>
              <div class="space-y-3 max-h-96 overflow-y-auto pr-2">
                @if (completedTomanRequests().length === 0) { <p class="text-center text-gray-500 py-4">هیچ درخواست تکمیل شده‌ای وجود ندارد.</p> } 
                @else { @for (req of completedTomanRequests(); track req.id) {
                    <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg opacity-80">
                      <div class="flex items-center justify-between">
                        <div>
                          <p class="font-bold text-gray-900 dark:text-white">{{ req.username }} - @if(req.type === 'toman_deposit') { واریز تومان } @else { برداشت تومان } </p>
                          <p class="font-mono">{{ req.amount | number:'1.0-0' }} تومان</p>
                          <p class="text-sm text-gray-600 dark:text-gray-400">{{ req.timestamp | date:'yyyy/MM/dd HH:mm' }}</p>
                        </div>
                        <span class="font-bold px-3 py-1 rounded-full text-sm flex-shrink-0" [class.bg-green-500/20]="req.status === 'approved'" [class.text-green-500 dark:text-green-400]="req.status === 'approved'" [class.bg-red-500/20]="req.status === 'rejected'" [class.text-red-500 dark:text-red-400]="req.status === 'rejected'">
                          @switch (req.status) { @case ('approved') { تایید شده } @case ('rejected') { رد شده } }
                        </span>
                      </div>
                    </div>
                } }
              </div>
            </div>
          </div>
        }
        @case('broadcast') {
            <div class="bg-gray-200 dark:bg-gray-700/50 p-6 rounded-lg border border-gray-500/30">
                <h2 class="text-xl font-bold text-gray-600 dark:text-gray-400 mb-6 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z" /></svg>
                    ارسال پیام همگانی به کاربران
                </h2>
                
                <div class="space-y-4">
                    <div class="flex flex-col">
                        <label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">عنوان پیام:</label>
                        <input type="text" [(ngModel)]="broadcastTitle" placeholder="مثلا: تعمیرات سیستم، تخفیف ویژه، و..." class="p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white">
                    </div>
                    
                    <div class="flex flex-col">
                        <label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">متن پیام:</label>
                        <textarea [(ngModel)]="broadcastMessage" rows="4" placeholder="متن اعلان را اینجا بنویسید..." class="p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"></textarea>
                    </div>

                    <button (click)="sendBroadcast()" [disabled]="!broadcastTitle() || !broadcastMessage()" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                        ارسال اعلان به تمام کاربران
                    </button>
                    
                    @if(broadcastStatus()) {
                        <div class="mt-4 p-3 bg-green-500/20 text-green-600 dark:text-green-400 rounded-lg text-center animate-fade-in font-bold">
                            {{ broadcastStatus() }}
                        </div>
                    }
                </div>
            </div>
        }
        @case ('settings') {
          <div class="space-y-8">
             <!-- Backup & Restore -->
             <div class="bg-gray-200 dark:bg-gray-700/50 p-6 rounded-lg border border-gray-500/30">
                <h2 class="text-xl font-bold text-gray-600 dark:text-gray-400 mb-4">پشتیبان‌گیری و بازیابی</h2>
                <div class="flex flex-col sm:flex-row gap-4">
                  <div class="flex-1">
                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">دانلود تمام اطلاعات صرافی (کاربران، تراکنش‌ها، تنظیمات) به صورت فایل.</p>
                    <button (click)="backupData()" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center gap-2">
                       <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                       پشتیبان‌گیری (Export)
                    </button>
                  </div>
                  <div class="flex-1">
                     <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">بازگردانی اطلاعات از فایل پشتیبان (هشدار: اطلاعات فعلی جایگزین می‌شود).</p>
                     <input type="file" id="restoreInput" (change)="onFileSelected($event)" accept=".json" class="hidden">
                     <button (click)="triggerRestore()" class="w-full bg-gray-500 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" transform="rotate(180 10 10)"/></svg>
                        بازگردانی (Import)
                     </button>
                  </div>
                </div>
             </div>

             <!-- Price Settings -->
             <div class="bg-gray-200 dark:bg-gray-700/50 p-6 rounded-lg border border-amber-500/30">
                <h2 class="text-xl font-bold text-amber-600 dark:text-amber-400 mb-4">تنظیمات نرخ و امنیت</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">حالت تعیین قیمت:</label>
                    <select [(ngModel)]="exchangeConfigForm().priceMode" class="w-full p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white">
                      <option value="auto">اتوماتیک (API)</option>
                      <option value="manual">دستی</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">نرخ تتر (دلار تهران) - تومان:</label>
                    <input type="number" [(ngModel)]="exchangeConfigForm().manualUsdtPrice" [disabled]="exchangeConfigForm().priceMode === 'auto'" class="w-full p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono disabled:opacity-50">
                    <p class="text-xs text-gray-500 mt-1">در حالت اتوماتیک، نرخ تقریبی 62,500 استفاده می‌شود (شبیه‌سازی).</p>
                  </div>
                   <div class="md:col-span-2 border-t border-gray-300 dark:border-gray-600 pt-4">
                     <label class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">رمز ورود ادمین (PIN):</label>
                     <input type="text" [(ngModel)]="exchangeConfigForm().adminPin" placeholder="برای غیرفعال کردن خالی بگذارید" class="w-full p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono tracking-widest text-center">
                     <p class="text-xs text-yellow-600 dark:text-yellow-500 mt-1">اگر پین ست کنید، هر بار ورود به پنل ادمین نیازمند وارد کردن این کد است.</p>
                  </div>
                </div>
                <button (click)="saveExchangeConfig()" class="mt-4 bg-amber-400 hover:bg-amber-500 text-black font-bold py-2 px-6 rounded-lg w-full">ذخیره تنظیمات کلی</button>
             </div>

             <!-- Toman Settings -->
             <div>
              <h2 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4">تنظیمات واریز تومان</h2>
              <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg space-y-4">
                <div class="flex flex-col"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">شماره کارت:</label><input type="text" [(ngModel)]="tomanDepositInfoForm().cardNumber" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                <div class="flex flex-col"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">شماره شبا (بدون IR):</label><input type="text" [(ngModel)]="tomanDepositInfoForm().shabaNumber" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                <div class="flex flex-col"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">آدرس ولت تتر (USDT):</label><input type="text" [(ngModel)]="tomanDepositInfoForm().usdtWalletAddress" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                <button (click)="saveTomanDepositInfo()" class="mt-4 bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-5 rounded-lg">ذخیره تنظیمات تومان</button>
              </div>
            </div>

            <!-- Crypto Settings -->
            <div>
              <h2 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4">تنظیمات واریز ارزها</h2>
              <div class="space-y-6">
                @for (crypto of cryptos(); track crypto.id) {
                  <div class="bg-gray-200 dark:bg-gray-700/50 p-4 rounded-lg">
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">{{ crypto.name }} ({{ crypto.symbol }})</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div class="flex flex-col"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">شماره کارت:</label><input type="text" [(ngModel)]="depositInfosForm()[crypto.id].cardNumber" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                      <div class="flex flex-col"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">شماره شبا (بدون IR):</label><input type="text" [(ngModel)]="depositInfosForm()[crypto.id].shabaNumber" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                      <div class="flex flex-col md:col-span-2"><label class="mb-2 font-semibold text-gray-700 dark:text-gray-300">آدرس ولت:</label><input type="text" [(ngModel)]="depositInfosForm()[crypto.id].walletAddress" class="p-2 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono"></div>
                    </div>
                    <button (click)="saveDepositInfo(crypto.id)" class="mt-4 bg-amber-400 hover:bg-amber-500 text-black font-bold py-2 px-5 rounded-lg">ذخیره</button>
                  </div>
                }
              </div>
            </div>
          </div>
        }
      }
    </main>
  </div>
}
